import{j as e}from"./vendor-three-ULghQGFO.js";import{b as t}from"./vendor-react-e4fu8oQ2.js";import{C as s,a}from"./index-qvyquVZZ.js";import{M as r,T as i,b as n,P as o,L as l}from"./leaflet-Dq1lRxp-.js";import"./vendor-utils-Ms3aQSpU.js";import"./vendor-ui-CIlOX7o0.js";import"./vendor-charts-DMm1PkpN.js";l.Icon.Default.mergeOptions({iconRetinaUrl:"/marker-icon-2x.png",iconUrl:"/marker-icon.png",shadowUrl:"/marker-shadow.png"});const c=()=>{const[l,c]=t.useState([]),[d,m]=t.useState(new Date),[h,x]=t.useState("connecting"),[g,p]=t.useState(""),v=async()=>{try{const e="http://localhost:8000",t=await fetch(`${e}/api/v1/realtime/geo-threats`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"},credentials:"omit"});if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);{const e=(await t.json()).data.map(((e,t)=>{const s=Math.random()>.6?"high":Math.random()>.3?"medium":"low",a=10*Math.random();return{id:t+1,location:j(e.location[0],e.location[1]),type:u(s),severity:s,lat:e.location[0],lng:e.location[1],exchange:e.exchange,timestamp:(new Date).toISOString(),details:y(s),impact_score:a}}));c(e),x("connected"),p("")}}catch(e){x("disconnected"),p(e instanceof Error?e.message:"Unknown error");c([{id:1,location:"New York",type:"JA3 Anomaly Detection",severity:"high",lat:40.7128,lng:-74.006,exchange:"Binance",details:"Suspicious TLS fingerprint patterns detected",impact_score:8.5},{id:2,location:"London",type:"Order Pattern Analysis",severity:"medium",lat:51.5074,lng:-.1278,exchange:"Kraken",details:"Unusual trading volume spikes identified",impact_score:6.2},{id:3,location:"Tokyo",type:"Latency Spike Alert",severity:"low",lat:35.6762,lng:139.6503,exchange:"Bitfinex",details:"Network latency above threshold",impact_score:3.1},{id:4,location:"Singapore",type:"Volume Manipulation",severity:"high",lat:1.3521,lng:103.8198,exchange:"OKX",details:"Coordinated trading activity detected",impact_score:9.1}])}},j=(e,t)=>[{name:"New York",lat:40.7128,lng:-74.006},{name:"London",lat:51.5074,lng:-.1278},{name:"Tokyo",lat:35.6762,lng:139.6503},{name:"Singapore",lat:1.3521,lng:103.8198},{name:"Frankfurt",lat:50.1109,lng:8.6821}].reduce(((s,a)=>{const r=Math.abs(s.lat-e)+Math.abs(s.lng-t);return Math.abs(a.lat-e)+Math.abs(a.lng-t)<r?a:s})).name,u=e=>{const t={high:["JA3 Anomaly Detection","Volume Manipulation","Coordinated Attack Pattern","TLS Fingerprint Spoofing"],medium:["Order Pattern Analysis","Unusual Trading Volume","Latency Anomaly","API Rate Limiting"],low:["Latency Spike Alert","Minor Volume Fluctuation","Connection Timeout","Network Congestion"]}[e];return t[Math.floor(Math.random()*t.length)]},y=e=>{const t={high:["Suspicious TLS fingerprint patterns detected","Coordinated trading activity identified","Advanced persistent threat indicators","Zero-day exploit attempt blocked"],medium:["Unusual trading volume spikes identified","API request pattern anomalies","Potential bot activity detected","Network traffic irregularities"],low:["Network latency above threshold","Minor connection instabilities","Routine security scan detected","Standard traffic fluctuations"]}[e];return t[Math.floor(Math.random()*t.length)]};t.useEffect((()=>{v();const e=setInterval((()=>{v(),m(new Date)}),5e3);return()=>clearInterval(e)}),[]);const b=e=>{switch(e){case"high":return"bg-red-500 border-red-400";case"medium":return"bg-yellow-500 border-yellow-400";case"low":return"bg-green-500 border-green-400";default:return"bg-gray-500 border-gray-400"}};return e.jsx(s,{className:"bg-gray-900 border border-gray-700 text-white",children:e.jsxs(a,{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Global Threat Map"}),e.jsxs("div",{className:"flex items-center gap-2 text-xs mt-1",children:[e.jsxs("span",{className:`${(()=>{switch(h){case"connected":return"text-green-400";case"connecting":return"text-yellow-400";case"disconnected":return"text-red-400";default:return"text-gray-400"}})()}`,children:["connected"===h&&"● LIVE","connecting"===h&&"◐ CONNECTING","disconnected"===h&&"● OFFLINE"]}),e.jsxs("span",{className:"text-gray-400",children:["Last Update: ",d.toLocaleTimeString()]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-semibold",children:[l.filter((e=>"high"===e.severity)).length," Critical Threats"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[l.length," Total Active"]})]})]}),g&&e.jsxs("div",{className:"bg-red-900 border border-red-600 p-2 rounded mb-4 text-sm",children:["Connection Error: ",g]}),e.jsx("div",{className:"bg-gray-800 h-96 rounded mb-4 border border-cyan-500/30 overflow-hidden",children:e.jsxs(r,{center:[20,0],zoom:2,style:{height:"100%",width:"100%"},children:[e.jsx(i,{url:"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors © <a href="https://carto.com/attributions">CARTO</a>'}),l.map((t=>e.jsx(n,{position:[t.lat,t.lng],children:e.jsx(o,{children:e.jsxs("div",{className:"p-2 bg-gray-900 text-white rounded",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${b(t.severity).replace("border-","bg-")}`}),e.jsx("h3",{className:"font-bold text-sm",children:t.type})]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Location:"})," ",t.location]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Exchange:"})," ",t.exchange]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Severity:"})," ",e.jsx("span",{className:"capitalize font-semibold",children:t.severity})]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Impact Score:"})," ",t.impact_score?.toFixed(2)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Details:"})," ",t.details]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Coordinates:"})," ",t.lat.toFixed(4),", ",t.lng.toFixed(4)]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Timestamp:"})," ",new Date(t.timestamp||"").toLocaleString()]})]})]})})},t.id)))]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-semibold glow-text",children:"Active Threats:"}),l.map((t=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 p-3 rounded border border-gray-600 hover:border-cyan-500/50 transition-all cursor-pointer",onClick:()=>(e=>{const t=`\nThreat Details:\nLocation: ${e.location}\nType: ${e.type}\nExchange: ${e.exchange}\nSeverity: ${e.severity.toUpperCase()}\nImpact Score: ${e.impact_score?.toFixed(2)}\nDetails: ${e.details}\nTimestamp: ${new Date(e.timestamp||"").toLocaleString()}\nCoordinates: ${e.lat.toFixed(4)}, ${e.lng.toFixed(4)}\n    `;alert(t)})(t),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 ${b(t.severity)} animate-pulse`}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:t.location}),e.jsx("span",{className:"text-xs text-cyan-400",children:t.exchange})]}),e.jsx("div",{className:"text-xs text-gray-400",children:t.type}),t.details&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:t.details})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-xs capitalize font-bold",children:t.severity}),t.impact_score&&e.jsxs("div",{className:"text-xs text-gray-400",children:["Impact: ",t.impact_score.toFixed(1)]})]})]},t.id)))]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2 text-xs text-center",children:[e.jsxs("div",{className:"bg-red-900 p-3 rounded border border-red-600",children:[e.jsx("div",{className:"font-semibold text-red-400",children:"High"}),e.jsx("div",{className:"text-lg font-bold",children:l.filter((e=>"high"===e.severity)).length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Critical"})]}),e.jsxs("div",{className:"bg-yellow-900 p-3 rounded border border-yellow-600",children:[e.jsx("div",{className:"font-semibold text-yellow-400",children:"Medium"}),e.jsx("div",{className:"text-lg font-bold",children:l.filter((e=>"medium"===e.severity)).length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Warning"})]}),e.jsxs("div",{className:"bg-green-900 p-3 rounded border border-green-600",children:[e.jsx("div",{className:"font-semibold text-green-400",children:"Low"}),e.jsx("div",{className:"text-lg font-bold",children:l.filter((e=>"low"===e.severity)).length}),e.jsx("div",{className:"text-xs text-gray-400",children:"Info"})]})]}),e.jsxs("div",{className:"mt-4 bg-gray-800 p-3 rounded border border-gray-600",children:[e.jsx("h4",{className:"font-semibold mb-2 text-cyan-400",children:"Threat Intelligence Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:["Active Exchanges: ",new Set(l.map((e=>e.exchange))).size]}),e.jsxs("div",{children:["Geographic Regions: ",new Set(l.map((e=>e.location))).size]}),e.jsxs("div",{children:["Avg Impact Score: ",(l.reduce(((e,t)=>e+(t.impact_score||0)),0)/l.length).toFixed(2)]}),e.jsxs("div",{children:["Last Scan: ",Math.floor(30*Math.random())," seconds ago"]})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-400",children:"Interactive map shows real-time threat locations. Click markers for detailed information."})]})]})})};export{c as default};
